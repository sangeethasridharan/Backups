package servlet;

import java.io.*;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.*;

@SuppressWarnings("serial")
public class RememberMeServlet extends HttpServlet {
	public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException, ServletException {
		resp.setContentType("text/html");
		PrintWriter out = resp.getWriter();
		Cookie[] ck1 = req.getCookies();
		HttpSession session = req.getSession(false);
		
			if(ck1 != null) {
				Cookie cookie = null;
				for(int i=0;i<ck1.length;i++)
	        	  {
					cookie = ck1[i];
					if(cookie.getName().equals("JSESSIONID"))
			          {
			        	  
						session.getAttribute("email");
						String sessName =(String)session.getAttribute("email");
						out.println("Welcome Back!!!  "+ sessName);
				        RequestDispatcher rd = req.getRequestDispatcher("/profile.html");
					    rd.include(req, resp);
						System.out.println(sessName);
					        
			          }
			          else
			          {
			        	  out.println("Welcome Back!!!  "+cookie.getValue());
				          RequestDispatcher rd = req.getRequestDispatcher("/profile.html");
					      rd.include(req, resp);
			          }
			          
	        	  }  
			          
			          
			       
			}
			else
			{
				resp.sendRedirect("index.jsp");
			}	
	}
}
